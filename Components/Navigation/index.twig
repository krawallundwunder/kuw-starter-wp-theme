<flynt-component
	name="Navigation" load:on="idle" load:on:media="(max-width: 1023px)">

	{# LÓGICA DE DADOS (Prepara a lista combinada) #}
	{% if menu and navigation_second %}
		{% set mobileItems = menu.items | merge(navigation_second.items) %}
	{% elseif menu %}
		{% set mobileItems = menu.items %}
	{% elseif navigation_second %}
		{% set mobileItems = navigation_second.items %}
	{% else %}
		{% set mobileItems = [] %}
	{% endif %}

	<nav class="border-b border-gray-800 bg-black relative z-50">
		<div class="container mx-auto px-4">
			<div
				class="flex h-20 items-center justify-between">

				{# LOGO #}
				{% if (header_logo and header_logo.src) or (logo and logo.src) %}
					<div class="z-50 relative">
						{% include "Partials/_logo.twig" with { header_logo: header_logo, logo: logo, site: site } %}
					</div>
				{% endif %}

				{# MENU DESKTOP #}
				<div class="hidden items-center space-x-8 lg:flex">
					{% include "Partials/_menuDesktop.twig" with { items: menu.items } %}
				</div>

				{# BOTÃO BURGER #}
				<button class="burger-btn group flex flex-col space-y-1.5 lg:hidden z-50 relative p-2" aria-label="Abrir menu">
					<span class="h-0.5 w-6 bg-white transition-all duration-300 group-[.active]:bg-yellow-400"></span>
					<span class="h-0.5 w-6 bg-white transition-all duration-300 group-[.active]:bg-yellow-400"></span>
					<span class="h-0.5 w-6 bg-white transition-all duration-300 group-[.active]:bg-yellow-400"></span>
				</button>
			</div>

			{# OVERLAY #}
			<div class="mobile-overlay fixed inset-0 z-40 hidden bg-black/60 opacity-0 backdrop-blur-sm transition-opacity duration-300 lg:hidden"></div>

			{# MENU DRAWER #}
			<div class="mobile-menu fixed top-0 right-0 z-50 h-full w-80 translate-x-full transform bg-black shadow-2xl transition-transform duration-300 ease-out lg:hidden overflow-y-auto border-l border-gray-800">
				<div
					class="flex h-full flex-col p-6">

					{# Header do Drawer #}
					<div class="mb-8 flex items-center justify-between">
						<h2 class="text-xl font-bold text-white uppercase tracking-wider">Menu</h2>
						<button class="mobile-close p-2 text-gray-400 hover:text-white transition-colors">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewbox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
							</svg>
						</button>
					</div>

					{# CORPO DO MENU #}
					<div
						class="flex-1 space-y-4">

						{# --- AQUI ENTRA O SEU NOVO PARTIAL --- #}
						{% include "Partials/_menuMobile.twig" with { items: mobileItems } only %}

						{# Botão CTA Mobile (Fica fora do loop, mas dentro do scroll) #}
						{% if button_link and button_link.url %}
							<div class="pt-6">
								<a class="mobile-menu-link block w-full text-center bg-white text-black font-bold py-3 px-4 rounded hover:bg-gray-200 transition-colors" href="{{ button_link.url }}" target="{{ button_link.target ? '_blank' : '_self' }}">
									{{ button_link.title }}
								</a>
							</div>
						{% endif %}

					</div>

					{# Footer do Drawer #}
					<div class="border-t border-gray-800 pt-6 text-xs text-gray-500">
						<p>&copy;
							{{ 'now'|date('Y') }}
							{{ site.title }}</p>
					</div>

				</div>
			</div>
		</div>
	</nav>
</flynt-component>
