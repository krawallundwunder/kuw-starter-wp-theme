<section class="component component-columns-module text-black py-16 lg:py-24 transition-all duration-300 ease-in-out">
	<div class="container mx-auto px-4 sm:px-6 lg:px-8">
		{% if tag or title or description %}
			<div class="">
				{% include "templates/_partials/headings.twig" with {
					tag: tag,
					title: title,
					description: description,
					buttons: buttons,
					textAlign: textAlignment ? 'text-' ~ textAlignment : null
				} %}
			</div>
		{% endif %}

		{% set aspectRatioValue = aspectRatio ?? '16:9' %}
		{% set aspectRatioClass = {
			'4:3': 'aspect-[4/3]',
			'16:9': 'aspect-video',
		}[aspectRatioValue] ?? 'aspect-video' %}

		<div class="grid grid-cols-1 gap-8 md:grid-flow-col md:auto-cols-fr md:grid-cols-{{ columns|length }}">
			{% for column in columns %}
				{% set has_link = column.button and column.button.url %}

				<div class="column js-column-item bg-gray-50 flex flex-col gap-4 md:gap-8 h-full rounded-lg p-1.5 transition-all duration-300 ease-in-out text-{{ textAlignment ?? 'start' }}">

					<div class="grow">
						{% if column.image %}
							<div class="column-image mb-8 {{ isImageRounded ? 'flex justify-center items-center' : '' }}">
								{% set isSvg = column.image.mime_type == 'image/svg+xml' %}

								{% if isImageRounded %}
									{# Abgerundete Bilder / Icons #}
									{% if isSvg %}
										<img src="{{ column.image.src }}" alt="{{ column.image.alt }}" loading="lazy" class="w-32 h-32 sm:w-40 sm:h-40 lg:w-48 lg:h-48 mx-auto flex items-center justify-center">
									{% else %}
										{# Normale Bilder - rund #}
										<img src="{{ column.image.src }}" alt="{{ column.image.alt }}" loading="lazy" class="rounded-full aspect-square mx-auto w-40 h-40 sm:w-48 sm:h-48 lg:w-56 lg:h-56 object-cover object-center">
									{% endif %}
								{% else %}
									{# Normale Bilder mit Aspect Ratio #}
									<img src="{{ column.image.src }}" alt="{{ column.image.alt }}" loading="lazy" class="w-full h-full rounded-lg object-cover object-center {{ aspectRatioClass }}">
								{% endif %}
							</div>
						{% endif %}

						<div class="mx-4 mb-4">
							{% if column.tag %}
								<div class="column-tag mb-1">
									<span class="inline-block text-xs font-medium text-black/60 uppercase tracking-wide">
										{{ column.tag }}
									</span>
								</div>
							{% endif %}

							{% if column.subtitle %}
								<div class="column-subtitle-container mb-2.5">
									<h3 class="js-column-subtitle column-subtitle text-2xl font-medium w-full text-black">
										{{ column.subtitle }}
									</h3>
								</div>
							{% endif %}

							{% if column.description %}
								<div class="column-description text-black/90 text-lg leading-tight font-light">
									{{ column.description|e('wp_kses_post') }}
								</div>
							{% endif %}
						</div>
					</div>

					{% if column.cardButton %}
						{% include "templates/_partials/button.twig" with {
							text: column.cardButton.title,
							link: column.cardButton.url,
							target: column.cardButton.target,
							variant: 'secondary',
						} %}
					{% endif %}

				</div>
			{% endfor %}
		</div>
	</div>
</section>
<style>
	.column-subtitle-container {
		min-height: var(--row-subtitle-height, auto);
		display: flex;
		align-items: flex-end;
	}
</style>

<script>
	(function () {
function equalizeColumnHeights() {
const components = document.querySelectorAll('.component-columns-module');

if (! components.length) {
return;
}

components.forEach(component => {
const columnItems = component.querySelectorAll('.js-column-item');

if (! columnItems.length) {
return;
}

let maxHeight = 0;

columnItems.forEach(item => {
item.style.removeProperty('--row-subtitle-height');
const subtitle = item.querySelector('.js-column-subtitle');
if (subtitle) {
subtitle.parentElement.style.minHeight = '0px';
}
});

requestAnimationFrame(() => {
columnItems.forEach(item => {
const subtitle = item.querySelector('.js-column-subtitle');
if (subtitle) {
const subtitleHeight = subtitle.getBoundingClientRect().height;
if (subtitleHeight > maxHeight) {
maxHeight = subtitleHeight;
}
subtitle.parentElement.style.removeProperty('min-height');
}
});

if (maxHeight > 0) {
columnItems.forEach(item => {
item.style.setProperty('--row-subtitle-height', `${maxHeight}px`);
});
}
});
});
}

document.addEventListener('DOMContentLoaded', equalizeColumnHeights);

let resizeTimeout;
window.addEventListener('resize', () => {
clearTimeout(resizeTimeout);
resizeTimeout = setTimeout(equalizeColumnHeights, 150);
});
})();
</script>
